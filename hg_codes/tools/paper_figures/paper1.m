

%% Wing weight 

% $$$$$$  A126  $$$$$$

% AR 10
A126_AR10_Eta100_structure=load('A126/AR10/Res_AR10_Eta_100_Structure');
A126_AR10_Eta90_structure=load('A126/AR10/Res_AR10_Eta_90_Structure');
A126_AR10_Eta80_structure=load('A126/AR10/Res_AR10_Eta_80_Structure');
A126_AR10_Eta70_structure=load('A126/AR10/Res_AR10_Eta_70_Structure');
A126_AR10_Eta60_structure=load('A126/AR10/Res_AR10_Eta_60_Structure');


% AR 13
A126_AR13_Eta100_structure=load('A126/AR13/Res_AR13_Eta_100_Structure');
A126_AR13_Eta90_structure=load('A126/AR13/Res_AR13_Eta_90_Structure');
A126_AR13_Eta80_structure=load('A126/AR13/Res_AR13_Eta_80_Structure');
A126_AR13_Eta70_structure=load('A126/AR13/Res_AR13_Eta_70_Structure');
A126_AR13_Eta60_structure=load('A126/AR13/Res_AR13_Eta_60_Structure');


% AR 16
A126_AR16_Eta100_structure=load('A126/AR16/Res_AR16_Eta_100_Structure');
A126_AR16_Eta90_structure=load('A126/AR16/Res_AR16_Eta_90_Structure');
A126_AR16_Eta80_structure=load('A126/AR16/Res_AR16_Eta_80_Structure');
A126_AR16_Eta70_structure=load('A126/AR16/Res_AR16_Eta_70_Structure');
A126_AR16_Eta60_structure=load('A126/AR16/Res_AR16_Eta_60_Structure');


% AR 19
A126_AR19_Eta100_structure=load('A126/AR19/Res_AR19_Eta_100_Structure');
A126_AR19_Eta90_structure=load('A126/AR19/Res_AR19_Eta_90_Structure');
A126_AR19_Eta80_structure=load('A126/AR19/Res_AR19_Eta_80_Structure');
A126_AR19_Eta70_structure=load('A126/AR19/Res_AR19_Eta_70_Structure');
A126_AR19_Eta60_structure=load('A126/AR19/Res_AR19_Eta_60_Structure');


% AR 22
A126_AR22_Eta100_structure=load('A126/AR22/Res_AR22_Eta_100_Structure');
A126_AR22_Eta90_structure=load('A126/AR22/Res_AR22_Eta_90_Structure');
A126_AR22_Eta80_structure=load('A126/AR22/Res_AR22_Eta_80_Structure');
A126_AR22_Eta70_structure=load('A126/AR22/Res_AR22_Eta_70_Structure');
A126_AR22_Eta60_structure=load('A126/AR22/Res_AR22_Eta_60_Structure');





% $$$$$$  A140  $$$$$$

% AR 10
A140_AR10_Eta100_structure=load('A140/AR10/Res_AR10_Eta_100_Structure');
A140_AR10_Eta90_structure=load('A140/AR10/Res_AR10_Eta_90_Structure');
A140_AR10_Eta80_structure=load('A140/AR10/Res_AR10_Eta_80_Structure');
A140_AR10_Eta70_structure=load('A140/AR10/Res_AR10_Eta_70_Structure');
A140_AR10_Eta60_structure=load('A140/AR10/Res_AR10_Eta_60_Structure');


% AR 13
A140_AR13_Eta100_structure=load('A140/AR13/Res_AR13_Eta_100_Structure');
A140_AR13_Eta90_structure=load('A140/AR13/Res_AR13_Eta_90_Structure');
A140_AR13_Eta80_structure=load('A140/AR13/Res_AR13_Eta_80_Structure');
A140_AR13_Eta70_structure=load('A140/AR13/Res_AR13_Eta_70_Structure');
A140_AR13_Eta60_structure=load('A140/AR13/Res_AR13_Eta_60_Structure');


% AR 16
A140_AR16_Eta100_structure=load('A140/AR16/Res_AR16_Eta_100_Structure');
A140_AR16_Eta90_structure=load('A140/AR16/Res_AR16_Eta_90_Structure');
A140_AR16_Eta80_structure=load('A140/AR16/Res_AR16_Eta_80_Structure');
A140_AR16_Eta70_structure=load('A140/AR16/Res_AR16_Eta_70_Structure');
A140_AR16_Eta60_structure=load('A140/AR16/Res_AR16_Eta_60_Structure');


% AR 19
A140_AR19_Eta100_structure=load('A140/AR19/Res_AR19_Eta_100_Structure');
A140_AR19_Eta90_structure=load('A140/AR19/Res_AR19_Eta_90_Structure');
A140_AR19_Eta80_structure=load('A140/AR19/Res_AR19_Eta_80_Structure');
A140_AR19_Eta70_structure=load('A140/AR19/Res_AR19_Eta_70_Structure');
A140_AR19_Eta60_structure=load('A140/AR19/Res_AR19_Eta_60_Structure');


% AR 22
A140_AR22_Eta100_structure=load('A140/AR22/Res_AR22_Eta_100_Structure');
A140_AR22_Eta90_structure=load('A140/AR22/Res_AR22_Eta_90_Structure');
A140_AR22_Eta80_structure=load('A140/AR22/Res_AR22_Eta_80_Structure');
A140_AR22_Eta70_structure=load('A140/AR22/Res_AR22_Eta_70_Structure');
A140_AR22_Eta60_structure=load('A140/AR22/Res_AR22_Eta_60_Structure');




% $$$$$$  A160  $$$$$$

% AR 10
A160_AR10_Eta100_structure=load('A160/AR10/Res_AR10_Eta_100_Structure');
A160_AR10_Eta90_structure=load('A160/AR10/Res_AR10_Eta_90_Structure');
A160_AR10_Eta80_structure=load('A160/AR10/Res_AR10_Eta_80_Structure');
A160_AR10_Eta70_structure=load('A160/AR10/Res_AR10_Eta_70_Structure');
A160_AR10_Eta60_structure=load('A160/AR10/Res_AR10_Eta_60_Structure');


% AR 13
A160_AR13_Eta100_structure=load('A160/AR13/Res_AR13_Eta_100_Structure');
A160_AR13_Eta90_structure=load('A160/AR13/Res_AR13_Eta_90_Structure');
A160_AR13_Eta80_structure=load('A160/AR13/Res_AR13_Eta_80_Structure');
A160_AR13_Eta70_structure=load('A160/AR13/Res_AR13_Eta_70_Structure');
A160_AR13_Eta60_structure=load('A160/AR13/Res_AR13_Eta_60_Structure');


% AR 16
A160_AR16_Eta100_structure=load('A160/AR16/Res_AR16_Eta_100_Structure');
A160_AR16_Eta90_structure=load('A160/AR16/Res_AR16_Eta_90_Structure');
A160_AR16_Eta80_structure=load('A160/AR16/Res_AR16_Eta_80_Structure');
A160_AR16_Eta70_structure=load('A160/AR16/Res_AR16_Eta_70_Structure');
A160_AR16_Eta60_structure=load('A160/AR16/Res_AR16_Eta_60_Structure');


% AR 19
A160_AR19_Eta100_structure=load('A160/AR19/Res_AR19_Eta_100_Structure');
A160_AR19_Eta90_structure=load('A160/AR19/Res_AR19_Eta_90_Structure');
A160_AR19_Eta80_structure=load('A160/AR19/Res_AR19_Eta_80_Structure');
A160_AR19_Eta70_structure=load('A160/AR19/Res_AR19_Eta_70_Structure');
A160_AR19_Eta60_structure=load('A160/AR19/Res_AR19_Eta_60_Structure');


% AR 22
A160_AR22_Eta100_structure=load('A160/AR22/Res_AR22_Eta_100_Structure');
A160_AR22_Eta90_structure=load('A160/AR22/Res_AR22_Eta_90_Structure');
A160_AR22_Eta80_structure=load('A160/AR22/Res_AR22_Eta_80_Structure');
A160_AR22_Eta70_structure=load('A160/AR22/Res_AR22_Eta_70_Structure');
A160_AR22_Eta60_structure=load('A160/AR22/Res_AR22_Eta_60_Structure');


%% ARs

AR=[10,13,16,19,22];

%% Assumptions of the secondary masses
Secondary_A126=1200*ones(1,5);
Secondary_A140=1300*ones(1,5);
Secondary_A160=1500*ones(1,5);


%% Assumption of the hinge mass
Hinge_Mass=200*ones(1,5);


%% sized wing masses

% $$$$$$$$ A126 $$$$$$$$

Wingbox_weight_A126_Eta100=[A126_AR10_Eta100_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR13_Eta100_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR16_Eta100_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR19_Eta100_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR22_Eta100_structure.Wingbox_property.Wingbox_Mass];


Wingbox_weight_A126_Eta90=[A126_AR10_Eta90_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR13_Eta90_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR16_Eta90_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR19_Eta90_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR22_Eta90_structure.Wingbox_property.Wingbox_Mass];


Wingbox_weight_A126_Eta80=[A126_AR10_Eta80_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR13_Eta80_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR16_Eta80_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR19_Eta80_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR22_Eta80_structure.Wingbox_property.Wingbox_Mass];


Wingbox_weight_A126_Eta70=[A126_AR10_Eta70_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR13_Eta70_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR16_Eta70_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR19_Eta70_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR22_Eta70_structure.Wingbox_property.Wingbox_Mass];


Wingbox_weight_A126_Eta60=[A126_AR10_Eta60_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR13_Eta60_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR16_Eta60_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR19_Eta60_structure.Wingbox_property.Wingbox_Mass,...
    A126_AR22_Eta60_structure.Wingbox_property.Wingbox_Mass];




% $$$$$$$$ A140 $$$$$$$$

Wingbox_weight_A140_Eta100=[A140_AR10_Eta100_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR13_Eta100_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR16_Eta100_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR19_Eta100_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR22_Eta100_structure.Wingbox_property.Wingbox_Mass];


Wingbox_weight_A140_Eta90=[A140_AR10_Eta90_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR13_Eta90_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR16_Eta90_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR19_Eta90_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR22_Eta90_structure.Wingbox_property.Wingbox_Mass];


Wingbox_weight_A140_Eta80=[A140_AR10_Eta80_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR13_Eta80_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR16_Eta80_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR19_Eta80_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR22_Eta80_structure.Wingbox_property.Wingbox_Mass];


Wingbox_weight_A140_Eta70=[A140_AR10_Eta70_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR13_Eta70_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR16_Eta70_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR19_Eta70_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR22_Eta70_structure.Wingbox_property.Wingbox_Mass];


Wingbox_weight_A140_Eta60=[A140_AR10_Eta60_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR13_Eta60_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR16_Eta60_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR19_Eta60_structure.Wingbox_property.Wingbox_Mass,...
    A140_AR22_Eta60_structure.Wingbox_property.Wingbox_Mass];





% $$$$$$$$ A160 $$$$$$$$

Wingbox_weight_A160_Eta100=[A160_AR10_Eta100_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR13_Eta100_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR16_Eta100_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR19_Eta100_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR22_Eta100_structure.Wingbox_property.Wingbox_Mass];


Wingbox_weight_A160_Eta90=[A160_AR10_Eta90_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR13_Eta90_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR16_Eta90_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR19_Eta90_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR22_Eta90_structure.Wingbox_property.Wingbox_Mass];


Wingbox_weight_A160_Eta80=[A160_AR10_Eta80_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR13_Eta80_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR16_Eta80_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR19_Eta80_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR22_Eta80_structure.Wingbox_property.Wingbox_Mass];


Wingbox_weight_A160_Eta70=[A160_AR10_Eta70_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR13_Eta70_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR16_Eta70_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR19_Eta70_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR22_Eta70_structure.Wingbox_property.Wingbox_Mass];


Wingbox_weight_A160_Eta60=[A160_AR10_Eta60_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR13_Eta60_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR16_Eta60_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR19_Eta60_structure.Wingbox_property.Wingbox_Mass,...
    A160_AR22_Eta60_structure.Wingbox_property.Wingbox_Mass];



%% Assumption of the rib mass

Rib_A126=Secondary_A126/3;
Rib_A140=Secondary_A140/3;
Rib_A160=Secondary_A160/3;


%% overall mass of the wings

Wing_weight_A126_Eta100=Wingbox_weight_A126_Eta100 + Secondary_A126 + Rib_A126;
Wing_weight_A126_Eta90=Wingbox_weight_A126_Eta90 + Secondary_A126 + Hinge_Mass + Rib_A126;
Wing_weight_A126_Eta80=Wingbox_weight_A126_Eta80 + Secondary_A126 + Hinge_Mass + Rib_A126;
Wing_weight_A126_Eta70=Wingbox_weight_A126_Eta70 + Secondary_A126 + Hinge_Mass + Rib_A126;
Wing_weight_A126_Eta60=Wingbox_weight_A126_Eta60 + Secondary_A126 + Hinge_Mass + Rib_A126;



Wing_weight_A140_Eta100=Wingbox_weight_A140_Eta100 + Secondary_A140 + Rib_A140;
Wing_weight_A140_Eta90=Wingbox_weight_A140_Eta90 + Secondary_A140 + Hinge_Mass + Rib_A140;
Wing_weight_A140_Eta80=Wingbox_weight_A140_Eta80 + Secondary_A140 + Hinge_Mass + Rib_A140;
Wing_weight_A140_Eta70=Wingbox_weight_A140_Eta70 + Secondary_A140 + Hinge_Mass + Rib_A140;
Wing_weight_A140_Eta60=Wingbox_weight_A140_Eta60 + Secondary_A140 + Hinge_Mass + Rib_A140;



Wing_weight_A160_Eta100=Wingbox_weight_A160_Eta100 + Secondary_A160+ Rib_A160;
Wing_weight_A160_Eta90=Wingbox_weight_A160_Eta90 + Secondary_A160 + Hinge_Mass + Rib_A160;
Wing_weight_A160_Eta80=Wingbox_weight_A160_Eta80 + Secondary_A160 + Hinge_Mass + Rib_A160;
Wing_weight_A160_Eta70=Wingbox_weight_A160_Eta70 + Secondary_A160 + Hinge_Mass + Rib_A160;
Wing_weight_A160_Eta60=Wingbox_weight_A160_Eta60 + Secondary_A160 + Hinge_Mass + Rib_A160;



figure % A126

plot(AR,Wing_weight_A126_Eta100,'-','Color',[0, 0.5, 0],'LineWidth',1)
hold on 
plot(AR,Wing_weight_A126_Eta90,'ks','MarkerFaceColor',[0, 0.5, 0])
hold on 
plot(AR,Wing_weight_A126_Eta80,'ko','MarkerFaceColor',[0, 0.5, 0])
hold on 
plot(AR,Wing_weight_A126_Eta70,'kv','MarkerFaceColor',[0, 0.5, 0])
hold on 
plot(AR,Wing_weight_A126_Eta60,'kd','MarkerFaceColor',[0, 0.5, 0])

xlabel('Wing aspect ratio (AR)','Interpreter','latex','FontSize',12)
ylabel('Overall wing mass (kg)','Interpreter','latex','FontSize',12)
set(gcf,'Color','w')
set(gca,'TickLabelInterpreter','latex')

set(gca,'FontSize',14)
legend('No FWT','$\eta = 10\%$','$\eta = 20\%$','$\eta = 30\%$','$\eta = 40\%$','Interpreter','latex','FontSize',12,'Location','northwest')

figure % A140

plot(AR,Wing_weight_A140_Eta100,'-','Color',[0.6350, 0.0780, 0.1840],'LineWidth',1)
hold on 
plot(AR,Wing_weight_A140_Eta90,'s','MarkerFaceColor',[0.6350, 0.0780, 0.1840])
hold on 
plot(AR,Wing_weight_A140_Eta80,'o','MarkerFaceColor',[0.6350, 0.0780, 0.1840])
hold on 
plot(AR,Wing_weight_A140_Eta70,'v','MarkerFaceColor',[0.6350, 0.0780, 0.1840])
hold on 
plot(AR,Wing_weight_A140_Eta60,'d','MarkerFaceColor',[0.6350, 0.0780, 0.1840])

xlabel('Wing aspect ratio (AR)','Interpreter','latex','FontSize',12)
ylabel('Overall wing mass (kg)','Interpreter','latex','FontSize',12)
set(gcf,'Color','w')
set(gca,'TickLabelInterpreter','latex')
set(gca,'FontSize',14)
legend('No FWT','$\eta = 10\%$','$\eta = 20\%$','$\eta = 30\%$','$\eta = 40\%$','Interpreter','latex','FontSize',12,'Location','northwest')


figure % A160

plot(AR,Wing_weight_A160_Eta100,'-','Color',[0.9290, 0.6940, 0.1250],'LineWidth',1)
hold on 
plot(AR,Wing_weight_A160_Eta90,'ks','MarkerFaceColor',[0.9290, 0.6940, 0.1250])
hold on 
plot(AR,Wing_weight_A160_Eta80,'ko','MarkerFaceColor',[0.9290, 0.6940, 0.1250])
hold on 
plot(AR,Wing_weight_A160_Eta70,'kv','MarkerFaceColor',[0.9290, 0.6940, 0.1250])
hold on 
plot(AR,Wing_weight_A160_Eta60,'kd','MarkerFaceColor',[0.9290, 0.6940, 0.1250])

xlabel('Wing aspect ratio (AR)','Interpreter','latex','FontSize',12)
ylabel('Overall wing mass (kg)','Interpreter','latex','FontSize',12)
set(gcf,'Color','w')
set(gca,'TickLabelInterpreter','latex')
set(gca,'FontSize',14)
legend('No FWT','$\eta = 10\%$','$\eta = 20\%$','$\eta = 30\%$','$\eta = 40\%$','Interpreter','latex','FontSize',12,'Location','northwest')




%% Aerodynamics


% zero-lift drag 

% $$$   A126   $$$

CD0_A126_AR10=Zero_Lift_Drag(A126_AR10_Eta100_structure,126);
CD0_A126_AR13=Zero_Lift_Drag(A126_AR13_Eta100_structure,126);
CD0_A126_AR16=Zero_Lift_Drag(A126_AR16_Eta100_structure,126);
CD0_A126_AR19=Zero_Lift_Drag(A126_AR19_Eta100_structure,126);
CD0_A126_AR22=Zero_Lift_Drag(A126_AR22_Eta100_structure,126);


% $$$   A140   $$$

CD0_A140_AR10=Zero_Lift_Drag(A140_AR10_Eta100_structure,140);
CD0_A140_AR13=Zero_Lift_Drag(A140_AR13_Eta100_structure,140);
CD0_A140_AR16=Zero_Lift_Drag(A140_AR16_Eta100_structure,140);
CD0_A140_AR19=Zero_Lift_Drag(A140_AR19_Eta100_structure,140);
CD0_A140_AR22=Zero_Lift_Drag(A140_AR22_Eta100_structure,140);


% $$$   A160   $$$

CD0_A160_AR10=Zero_Lift_Drag(A160_AR10_Eta100_structure,160);
CD0_A160_AR13=Zero_Lift_Drag(A160_AR13_Eta100_structure,160);
CD0_A160_AR16=Zero_Lift_Drag(A160_AR16_Eta100_structure,160);
CD0_A160_AR19=Zero_Lift_Drag(A160_AR19_Eta100_structure,160);
CD0_A160_AR22=Zero_Lift_Drag(A160_AR22_Eta100_structure,160);

% Induced drag 

% $$$   A126   $$$
A126_AR10_Eta100_Aero=load('A126/AR10/Res_AR10_Eta_100_Aero');
A126_AR13_Eta100_Aero=load('A126/AR13/Res_AR13_Eta_100_Aero');
A126_AR16_Eta100_Aero=load('A126/AR16/Res_AR16_Eta_100_Aero');
A126_AR19_Eta100_Aero=load('A126/AR19/Res_AR19_Eta_100_Aero');
A126_AR22_Eta100_Aero=load('A126/AR22/Res_AR22_Eta_100_Aero');


% $$$   A140   $$$
A140_AR10_Eta100_Aero=load('A140/AR10/Res_AR10_Eta_100_Aero');
A140_AR13_Eta100_Aero=load('A140/AR13/Res_AR13_Eta_100_Aero');
A140_AR16_Eta100_Aero=load('A140/AR16/Res_AR16_Eta_100_Aero');
A140_AR19_Eta100_Aero=load('A140/AR19/Res_AR19_Eta_100_Aero');
A140_AR22_Eta100_Aero=load('A140/AR22/Res_AR22_Eta_100_Aero');


% $$$   A160   $$$
A160_AR10_Eta100_Aero=load('A160/AR10/Res_AR10_Eta_100_Aero');
A160_AR13_Eta100_Aero=load('A160/AR13/Res_AR13_Eta_100_Aero');
A160_AR16_Eta100_Aero=load('A160/AR16/Res_AR16_Eta_100_Aero');
A160_AR19_Eta100_Aero=load('A160/AR19/Res_AR19_Eta_100_Aero');
A160_AR22_Eta100_Aero=load('A160/AR22/Res_AR22_Eta_100_Aero');


%  summery of K values 
% A126_K=[A126_AR10_Eta100_Aero.Aerodynamics.k,A126_AR13_Eta100_Aero.Aerodynamics.k,A126_AR16_Eta100_Aero.Aerodynamics.k,A126_AR19_Eta100_Aero.Aerodynamics.k,A126_AR22_Eta100_Aero.Aerodynamics.k];
% A140_K=[A140_AR10_Eta100_Aero.Aerodynamics.k,A140_AR13_Eta100_Aero.Aerodynamics.k,A140_AR16_Eta100_Aero.Aerodynamics.k,A140_AR19_Eta100_Aero.Aerodynamics.k,A140_AR22_Eta100_Aero.Aerodynamics.k];
% A160_K=[A160_AR10_Eta100_Aero.Aerodynamics.k,A160_AR13_Eta100_Aero.Aerodynamics.k,A160_AR16_Eta100_Aero.Aerodynamics.k,A160_AR19_Eta100_Aero.Aerodynamics.k,A160_AR22_Eta100_Aero.Aerodynamics.k];

A126_K=[1/(pi*10),1/(pi*13),1/(pi*16),1/(pi*19),1/(pi*22)];
A140_K=[1/(pi*10),1/(pi*13),1/(pi*16),1/(pi*19),1/(pi*22)];
A160_K=[1/(pi*10),1/(pi*13),1/(pi*16),1/(pi*19),1/(pi*22)];

% select Cl range

CL=0:0.1:1.2;

% % Drags for A126
% 
% CD_A126_AR10 = CD0_A126_AR10 + abs(A126_K(1)).*CL.^2;
% CD_A126_AR13 = CD0_A126_AR13 + abs(A126_K(2)).*CL.^2;
% CD_A126_AR16 = CD0_A126_AR16 + abs(A126_K(3)).*CL.^2;
% CD_A126_AR19 = CD0_A126_AR19 + abs(A126_K(4)).*CL.^2;
% CD_A126_AR22 = CD0_A126_AR22 + abs(A126_K(5)).*CL.^2;
% 
% % Drags for A140
% 
% CD_A140_AR10 = CD0_A140_AR10 + abs(A140_K(1)).*CL.^2;
% CD_A140_AR13 = CD0_A140_AR13 + abs(A140_K(2)).*CL.^2;
% CD_A140_AR16 = CD0_A140_AR16 + abs(A140_K(3)).*CL.^2;
% CD_A140_AR19 = CD0_A140_AR19 + abs(A140_K(4)).*CL.^2;
% CD_A140_AR22 = CD0_A140_AR22 + abs(A140_K(5)).*CL.^2;
% 
% 
% % Drags for A160
% 
% CD_A160_AR10 = CD0_A160_AR10 + abs(A160_K(1)).*CL.^2;
% CD_A160_AR13 = CD0_A160_AR13 + abs(A160_K(2)).*CL.^2;
% CD_A160_AR16 = CD0_A160_AR16 + abs(A160_K(3)).*CL.^2;
% CD_A160_AR19 = CD0_A160_AR19 + abs(A160_K(4)).*CL.^2;
% CD_A160_AR22 = CD0_A160_AR22 + abs(A160_K(5)).*CL.^2;



% Drags for A126

CD_A126_AR10 = CD0_A126_AR10 + (1/(pi*10)).*CL.^2;
CD_A126_AR13 = CD0_A126_AR13 + (1/(pi*13)).*CL.^2;
CD_A126_AR16 = CD0_A126_AR16 + (1/(pi*16)).*CL.^2;
CD_A126_AR19 = CD0_A126_AR19 + (1/(pi*19)).*CL.^2;
CD_A126_AR22 = CD0_A126_AR22 + (1/(pi*22)).*CL.^2;

% Drags for A140

CD_A140_AR10 = CD0_A140_AR10 + (1/(pi*10)).*CL.^2;
CD_A140_AR13 = CD0_A140_AR13 + (1/(pi*13)).*CL.^2;
CD_A140_AR16 = CD0_A140_AR16 + (1/(pi*16)).*CL.^2;
CD_A140_AR19 = CD0_A140_AR19 + (1/(pi*19)).*CL.^2;
CD_A140_AR22 = CD0_A140_AR22 + (1/(pi*22)).*CL.^2;


% Drags for A160

CD_A160_AR10 = CD0_A160_AR10 + (1/(pi*10)).*CL.^2;
CD_A160_AR13 = CD0_A160_AR13 + (1/(pi*13)).*CL.^2;
CD_A160_AR16 = CD0_A160_AR16 + (1/(pi*16)).*CL.^2;
CD_A160_AR19 = CD0_A160_AR19 + (1/(pi*19)).*CL.^2;
CD_A160_AR22 = CD0_A160_AR22 + (1/(pi*22)).*CL.^2;

 
figure % A126
plot(CD_A126_AR10,CL,'-','Color',[0, 0.5, 0],'LineWidth',1.2)
hold on 
plot(CD_A126_AR13,CL,'-','Color','r','LineWidth',1.2)
hold on 
plot(CD_A126_AR16,CL,'-','Color',[0.6350, 0.0780, 0.1840],'LineWidth',1.2)
hold on 
plot(CD_A126_AR19,CL,'-','Color','b','LineWidth',1.2)
hold on 
plot(CD_A126_AR22,CL,'-','Color','k','LineWidth',1.2)



xlabel('Drag coefficient','Interpreter','latex','FontSize',12)
ylabel('Lift coefficient','Interpreter','latex','FontSize',12)
set(gcf,'Color','w')
set(gca,'TickLabelInterpreter','latex')
legend('AR = 10','AR = 13','AR = 16','AR = 19','AR = 22','Interpreter','latex','FontSize',12,'Location','southeast')
grid on
grid minor


figure % A140
plot(CD_A140_AR10,CL,'-','Color',[0, 0.5, 0],'LineWidth',1.2)
hold on 
plot(CD_A140_AR13,CL,'-','Color','r','LineWidth',1.2)
hold on 
plot(CD_A140_AR16,CL,'-','Color',[0.6350, 0.0780, 0.1840],'LineWidth',1.2)
hold on 
plot(CD_A140_AR19,CL,'-','Color','b','LineWidth',1.2)
hold on 
plot(CD_A140_AR22,CL,'-','Color','k','LineWidth',1.2)


xlabel('Drag coefficient','Interpreter','latex','FontSize',12)
ylabel('Lift coefficient','Interpreter','latex','FontSize',12)
set(gcf,'Color','w')
set(gca,'TickLabelInterpreter','latex')
legend('AR = 10','AR = 13','AR = 16','AR = 19','AR = 22','Interpreter','latex','FontSize',12,'Location','southeast')
grid on
grid minor


figure % A160
plot(CD_A160_AR10,CL,'-','Color',[0, 0.5, 0],'LineWidth',1.2)
hold on 
plot(CD_A160_AR13,CL,'-','Color','r','LineWidth',1.2)
hold on 
plot(CD_A160_AR16,CL,'-','Color',[0.6350, 0.0780, 0.1840],'LineWidth',1.2)
hold on 
plot(CD_A160_AR19,CL,'-','Color','b','LineWidth',1.2)
hold on 
plot(CD_A160_AR22,CL,'-','Color','k','LineWidth',1.2)


xlabel('Drag coefficient','Interpreter','latex','FontSize',12)
ylabel('Lift coefficient','Interpreter','latex','FontSize',12)
set(gcf,'Color','w')
set(gca,'TickLabelInterpreter','latex')
legend('AR = 10','AR = 13','AR = 16','AR = 19','AR = 22','Interpreter','latex','FontSize',12,'Location','southeast')
grid on
grid minor



%% Range 

Fixed_Structure=40000; %kg
Payload=25000*0.5; % kg
Fuel_Mass=27000*0.5; % kg

% A = 126 

% AR 10
TOW_A126_AR10_Eta100 = Fixed_Structure + 2*Wing_weight_A126_Eta100(1) + Payload + Fuel_Mass;
TOW_A126_AR10_Eta90 = Fixed_Structure + 2*Wing_weight_A126_Eta90(1) + Payload + Fuel_Mass;
TOW_A126_AR10_Eta80 = Fixed_Structure + 2*Wing_weight_A126_Eta80(1) + Payload + Fuel_Mass;
TOW_A126_AR10_Eta70 = Fixed_Structure + 2*Wing_weight_A126_Eta70(1) + Payload + Fuel_Mass;
TOW_A126_AR10_Eta60 = Fixed_Structure + 2*Wing_weight_A126_Eta60(1) + Payload + Fuel_Mass;


A126_AR10_OWE=[Fixed_Structure + 2*Wing_weight_A126_Eta100(1);...
    Fixed_Structure + 2*Wing_weight_A126_Eta90(1);...
    Fixed_Structure + 2*Wing_weight_A126_Eta80(1);...
    Fixed_Structure + 2*Wing_weight_A126_Eta70(1);...
    Fixed_Structure + 2*Wing_weight_A126_Eta60(1)];



% AR 13
TOW_A126_AR13_Eta100 = Fixed_Structure + 2*Wing_weight_A126_Eta100(2) + Payload + Fuel_Mass;
TOW_A126_AR13_Eta90 = Fixed_Structure + 2*Wing_weight_A126_Eta90(2) + Payload + Fuel_Mass;
TOW_A126_AR13_Eta80 = Fixed_Structure + 2*Wing_weight_A126_Eta80(2) + Payload + Fuel_Mass;
TOW_A126_AR13_Eta70 = Fixed_Structure + 2*Wing_weight_A126_Eta70(2) + Payload + Fuel_Mass;
TOW_A126_AR13_Eta60 = Fixed_Structure + 2*Wing_weight_A126_Eta60(2) + Payload + Fuel_Mass;


A126_AR13_OWE=[Fixed_Structure + 2*Wing_weight_A126_Eta100(2);...
    Fixed_Structure + 2*Wing_weight_A126_Eta90(2);...
    Fixed_Structure + 2*Wing_weight_A126_Eta80(2);...
    Fixed_Structure + 2*Wing_weight_A126_Eta70(2);...
    Fixed_Structure + 2*Wing_weight_A126_Eta60(2)];



% AR 16
TOW_A126_AR16_Eta100 = Fixed_Structure + 2*Wing_weight_A126_Eta100(3) + Payload + Fuel_Mass;
TOW_A126_AR16_Eta90 = Fixed_Structure + 2*Wing_weight_A126_Eta90(3) + Payload + Fuel_Mass;
TOW_A126_AR16_Eta80 = Fixed_Structure + 2*Wing_weight_A126_Eta80(3) + Payload + Fuel_Mass;
TOW_A126_AR16_Eta70 = Fixed_Structure + 2*Wing_weight_A126_Eta70(3) + Payload + Fuel_Mass;
TOW_A126_AR16_Eta60 = Fixed_Structure + 2*Wing_weight_A126_Eta60(3) + Payload + Fuel_Mass;


A126_AR16_OWE=[Fixed_Structure + 2*Wing_weight_A126_Eta100(3);...
    Fixed_Structure + 2*Wing_weight_A126_Eta90(3);...
    Fixed_Structure + 2*Wing_weight_A126_Eta80(3);...
    Fixed_Structure + 2*Wing_weight_A126_Eta70(3);...
    Fixed_Structure + 2*Wing_weight_A126_Eta60(3)];




% AR 19
TOW_A126_AR19_Eta100 = Fixed_Structure + 2*Wing_weight_A126_Eta100(4) + Payload + Fuel_Mass;
TOW_A126_AR19_Eta90 = Fixed_Structure + 2*Wing_weight_A126_Eta90(4) + Payload + Fuel_Mass;
TOW_A126_AR19_Eta80 = Fixed_Structure + 2*Wing_weight_A126_Eta80(4) + Payload + Fuel_Mass;
TOW_A126_AR19_Eta70 = Fixed_Structure + 2*Wing_weight_A126_Eta70(4) + Payload + Fuel_Mass;
TOW_A126_AR19_Eta60 = Fixed_Structure + 2*Wing_weight_A126_Eta60(4) + Payload + Fuel_Mass;


A126_AR19_OWE=[Fixed_Structure + 2*Wing_weight_A126_Eta100(4);...
    Fixed_Structure + 2*Wing_weight_A126_Eta90(4);...
    Fixed_Structure + 2*Wing_weight_A126_Eta80(4);...
    Fixed_Structure + 2*Wing_weight_A126_Eta70(4);...
    Fixed_Structure + 2*Wing_weight_A126_Eta60(4)];




% AR 22
TOW_A126_AR22_Eta100 = Fixed_Structure + 2*Wing_weight_A126_Eta100(5) + Payload + Fuel_Mass;
TOW_A126_AR22_Eta90 = Fixed_Structure + 2*Wing_weight_A126_Eta90(5) + Payload + Fuel_Mass;
TOW_A126_AR22_Eta80 = Fixed_Structure + 2*Wing_weight_A126_Eta80(5) + Payload + Fuel_Mass;
TOW_A126_AR22_Eta70 = Fixed_Structure + 2*Wing_weight_A126_Eta70(5) + Payload + Fuel_Mass;
TOW_A126_AR22_Eta60 = Fixed_Structure + 2*Wing_weight_A126_Eta60(5) + Payload + Fuel_Mass;


A126_AR22_OWE=[Fixed_Structure + 2*Wing_weight_A126_Eta100(5);...
    Fixed_Structure + 2*Wing_weight_A126_Eta90(5);...
    Fixed_Structure + 2*Wing_weight_A126_Eta80(5);...
    Fixed_Structure + 2*Wing_weight_A126_Eta70(5);...
    Fixed_Structure + 2*Wing_weight_A126_Eta60(5)];



% A = 140 

% AR 10
TOW_A140_AR10_Eta100 = Fixed_Structure + 2*Wing_weight_A140_Eta100(1) + Payload + Fuel_Mass;
TOW_A140_AR10_Eta90 = Fixed_Structure + 2*Wing_weight_A140_Eta90(1) + Payload + Fuel_Mass;
TOW_A140_AR10_Eta80 = Fixed_Structure + 2*Wing_weight_A140_Eta80(1) + Payload + Fuel_Mass;
TOW_A140_AR10_Eta70 = Fixed_Structure + 2*Wing_weight_A140_Eta70(1) + Payload + Fuel_Mass;
TOW_A140_AR10_Eta60 = Fixed_Structure + 2*Wing_weight_A140_Eta60(1) + Payload + Fuel_Mass;


A140_AR10_OWE=[Fixed_Structure + 2*Wing_weight_A140_Eta100(1);...
    Fixed_Structure + 2*Wing_weight_A140_Eta90(1);...
    Fixed_Structure + 2*Wing_weight_A140_Eta80(1);...
    Fixed_Structure + 2*Wing_weight_A140_Eta70(1);...
    Fixed_Structure + 2*Wing_weight_A140_Eta60(1)];



% AR 13
TOW_A140_AR13_Eta100 = Fixed_Structure + 2*Wing_weight_A140_Eta100(2) + Payload + Fuel_Mass;
TOW_A140_AR13_Eta90 = Fixed_Structure + 2*Wing_weight_A140_Eta90(2) + Payload + Fuel_Mass;
TOW_A140_AR13_Eta80 = Fixed_Structure + 2*Wing_weight_A140_Eta80(2) + Payload + Fuel_Mass;
TOW_A140_AR13_Eta70 = Fixed_Structure + 2*Wing_weight_A140_Eta70(2) + Payload + Fuel_Mass;
TOW_A140_AR13_Eta60 = Fixed_Structure + 2*Wing_weight_A140_Eta60(2) + Payload + Fuel_Mass;


A140_AR13_OWE=[Fixed_Structure + 2*Wing_weight_A140_Eta100(2);...
    Fixed_Structure + 2*Wing_weight_A140_Eta90(2);...
    Fixed_Structure + 2*Wing_weight_A140_Eta80(2);...
    Fixed_Structure + 2*Wing_weight_A140_Eta70(2);...
    Fixed_Structure + 2*Wing_weight_A140_Eta60(2)];




% AR 16
TOW_A140_AR16_Eta100 = Fixed_Structure + 2*Wing_weight_A140_Eta100(3) + Payload + Fuel_Mass;
TOW_A140_AR16_Eta90 = Fixed_Structure + 2*Wing_weight_A140_Eta90(3) + Payload + Fuel_Mass;
TOW_A140_AR16_Eta80 = Fixed_Structure + 2*Wing_weight_A140_Eta80(3) + Payload + Fuel_Mass;
TOW_A140_AR16_Eta70 = Fixed_Structure + 2*Wing_weight_A140_Eta70(3) + Payload + Fuel_Mass;
TOW_A140_AR16_Eta60 = Fixed_Structure + 2*Wing_weight_A140_Eta60(3) + Payload + Fuel_Mass;


A140_AR16_OWE=[Fixed_Structure + 2*Wing_weight_A140_Eta100(3);...
    Fixed_Structure + 2*Wing_weight_A140_Eta90(3);...
    Fixed_Structure + 2*Wing_weight_A140_Eta80(3);...
    Fixed_Structure + 2*Wing_weight_A140_Eta70(3);...
    Fixed_Structure + 2*Wing_weight_A140_Eta60(3)];



% AR 19
TOW_A140_AR19_Eta100 = Fixed_Structure + 2*Wing_weight_A140_Eta100(4) + Payload + Fuel_Mass;
TOW_A140_AR19_Eta90 = Fixed_Structure + 2*Wing_weight_A140_Eta90(4) + Payload + Fuel_Mass;
TOW_A140_AR19_Eta80 = Fixed_Structure + 2*Wing_weight_A140_Eta80(4) + Payload + Fuel_Mass;
TOW_A140_AR19_Eta70 = Fixed_Structure + 2*Wing_weight_A140_Eta70(4) + Payload + Fuel_Mass;
TOW_A140_AR19_Eta60 = Fixed_Structure + 2*Wing_weight_A140_Eta60(4) + Payload + Fuel_Mass;


A140_AR19_OWE=[Fixed_Structure + 2*Wing_weight_A140_Eta100(4);...
    Fixed_Structure + 2*Wing_weight_A140_Eta90(4);...
    Fixed_Structure + 2*Wing_weight_A140_Eta80(4);...
    Fixed_Structure + 2*Wing_weight_A140_Eta70(4);...
    Fixed_Structure + 2*Wing_weight_A140_Eta60(4)];



% AR 22
TOW_A140_AR22_Eta100 = Fixed_Structure + 2*Wing_weight_A140_Eta100(5) + Payload + Fuel_Mass;
TOW_A140_AR22_Eta90 = Fixed_Structure + 2*Wing_weight_A140_Eta90(5) + Payload + Fuel_Mass;
TOW_A140_AR22_Eta80 = Fixed_Structure + 2*Wing_weight_A140_Eta80(5) + Payload + Fuel_Mass;
TOW_A140_AR22_Eta70 = Fixed_Structure + 2*Wing_weight_A140_Eta70(5) + Payload + Fuel_Mass;
TOW_A140_AR22_Eta60 = Fixed_Structure + 2*Wing_weight_A140_Eta60(5) + Payload + Fuel_Mass;


A140_AR22_OWE=[Fixed_Structure + 2*Wing_weight_A140_Eta100(5);...
    Fixed_Structure + 2*Wing_weight_A140_Eta90(5);...
    Fixed_Structure + 2*Wing_weight_A140_Eta80(5);...
    Fixed_Structure + 2*Wing_weight_A140_Eta70(5);...
    Fixed_Structure + 2*Wing_weight_A140_Eta60(5)];



% A = 160 

% AR 10
TOW_A160_AR10_Eta100 = Fixed_Structure + 2*Wing_weight_A160_Eta100(1) + Payload + Fuel_Mass;
TOW_A160_AR10_Eta90 = Fixed_Structure + 2*Wing_weight_A160_Eta90(1) + Payload + Fuel_Mass;
TOW_A160_AR10_Eta80 = Fixed_Structure + 2*Wing_weight_A160_Eta80(1) + Payload + Fuel_Mass;
TOW_A160_AR10_Eta70 = Fixed_Structure + 2*Wing_weight_A160_Eta70(1) + Payload + Fuel_Mass;
TOW_A160_AR10_Eta60 = Fixed_Structure + 2*Wing_weight_A160_Eta60(1) + Payload + Fuel_Mass;


A160_AR10_OWE=[Fixed_Structure + 2*Wing_weight_A160_Eta100(1);...
    Fixed_Structure + 2*Wing_weight_A160_Eta90(1);...
    Fixed_Structure + 2*Wing_weight_A160_Eta80(1);...
    Fixed_Structure + 2*Wing_weight_A160_Eta70(1);...
    Fixed_Structure + 2*Wing_weight_A160_Eta60(1)];



% AR 13
TOW_A160_AR13_Eta100 = Fixed_Structure + 2*Wing_weight_A160_Eta100(2) + Payload + Fuel_Mass;
TOW_A160_AR13_Eta90 = Fixed_Structure + 2*Wing_weight_A160_Eta90(2) + Payload + Fuel_Mass;
TOW_A160_AR13_Eta80 = Fixed_Structure + 2*Wing_weight_A160_Eta80(2) + Payload + Fuel_Mass;
TOW_A160_AR13_Eta70 = Fixed_Structure + 2*Wing_weight_A160_Eta70(2) + Payload + Fuel_Mass;
TOW_A160_AR13_Eta60 = Fixed_Structure + 2*Wing_weight_A160_Eta60(2) + Payload + Fuel_Mass;


A160_AR13_OWE=[Fixed_Structure + 2*Wing_weight_A160_Eta100(2);...
    Fixed_Structure + 2*Wing_weight_A160_Eta90(2);...
    Fixed_Structure + 2*Wing_weight_A160_Eta80(2);...
    Fixed_Structure + 2*Wing_weight_A160_Eta70(2);...
    Fixed_Structure + 2*Wing_weight_A160_Eta60(2)];



% AR 16
TOW_A160_AR16_Eta100 = Fixed_Structure + 2*Wing_weight_A160_Eta100(3) + Payload + Fuel_Mass;
TOW_A160_AR16_Eta90 = Fixed_Structure + 2*Wing_weight_A160_Eta90(3) + Payload + Fuel_Mass;
TOW_A160_AR16_Eta80 = Fixed_Structure + 2*Wing_weight_A160_Eta80(3) + Payload + Fuel_Mass;
TOW_A160_AR16_Eta70 = Fixed_Structure + 2*Wing_weight_A160_Eta70(3) + Payload + Fuel_Mass;
TOW_A160_AR16_Eta60 = Fixed_Structure + 2*Wing_weight_A160_Eta60(3) + Payload + Fuel_Mass;

A160_AR16_OWE=[Fixed_Structure + 2*Wing_weight_A160_Eta100(3);...
    Fixed_Structure + 2*Wing_weight_A160_Eta90(3);...
    Fixed_Structure + 2*Wing_weight_A160_Eta80(3);...
    Fixed_Structure + 2*Wing_weight_A160_Eta70(3);...
    Fixed_Structure + 2*Wing_weight_A160_Eta60(3)];



% AR 19
TOW_A160_AR19_Eta100 = Fixed_Structure + 2*Wing_weight_A160_Eta100(4) + Payload + Fuel_Mass;
TOW_A160_AR19_Eta90 = Fixed_Structure + 2*Wing_weight_A160_Eta90(4) + Payload + Fuel_Mass;
TOW_A160_AR19_Eta80 = Fixed_Structure + 2*Wing_weight_A160_Eta80(4) + Payload + Fuel_Mass;
TOW_A160_AR19_Eta70 = Fixed_Structure + 2*Wing_weight_A160_Eta70(4) + Payload + Fuel_Mass;
TOW_A160_AR19_Eta60 = Fixed_Structure + 2*Wing_weight_A160_Eta60(4) + Payload + Fuel_Mass;


A160_AR19_OWE=[Fixed_Structure + 2*Wing_weight_A160_Eta100(4);...
    Fixed_Structure + 2*Wing_weight_A160_Eta90(4);...
    Fixed_Structure + 2*Wing_weight_A160_Eta80(4);...
    Fixed_Structure + 2*Wing_weight_A160_Eta70(4);...
    Fixed_Structure + 2*Wing_weight_A160_Eta60(4)];



% AR 22
TOW_A160_AR22_Eta100 = Fixed_Structure + 2*Wing_weight_A160_Eta100(5) + Payload + Fuel_Mass;
TOW_A160_AR22_Eta90 = Fixed_Structure + 2*Wing_weight_A160_Eta90(5) + Payload + Fuel_Mass;
TOW_A160_AR22_Eta80 = Fixed_Structure + 2*Wing_weight_A160_Eta80(5) + Payload + Fuel_Mass;
TOW_A160_AR22_Eta70 = Fixed_Structure + 2*Wing_weight_A160_Eta70(5) + Payload + Fuel_Mass;
TOW_A160_AR22_Eta60 = Fixed_Structure + 2*Wing_weight_A160_Eta60(5) + Payload + Fuel_Mass;


A160_AR22_OWE=[Fixed_Structure + 2*Wing_weight_A160_Eta100(5);...
    Fixed_Structure + 2*Wing_weight_A160_Eta90(5);...
    Fixed_Structure + 2*Wing_weight_A160_Eta80(5);...
    Fixed_Structure + 2*Wing_weight_A160_Eta70(5);...
    Fixed_Structure + 2*Wing_weight_A160_Eta60(5)];


% TOW for A126 
TOW_A126_Eta100=[TOW_A126_AR10_Eta100,TOW_A126_AR13_Eta100,TOW_A126_AR16_Eta100,TOW_A126_AR19_Eta100,TOW_A126_AR22_Eta100];
TOW_A126_Eta90=[TOW_A126_AR10_Eta90,TOW_A126_AR13_Eta90,TOW_A126_AR16_Eta90,TOW_A126_AR19_Eta90,TOW_A126_AR22_Eta90];
TOW_A126_Eta80=[TOW_A126_AR10_Eta80,TOW_A126_AR13_Eta80,TOW_A126_AR16_Eta80,TOW_A126_AR19_Eta80,TOW_A126_AR22_Eta80];
TOW_A126_Eta70=[TOW_A126_AR10_Eta70,TOW_A126_AR13_Eta70,TOW_A126_AR16_Eta70,TOW_A126_AR19_Eta70,TOW_A126_AR22_Eta70];
TOW_A126_Eta60=[TOW_A126_AR10_Eta60,TOW_A126_AR13_Eta60,TOW_A126_AR16_Eta60,TOW_A126_AR19_Eta60,TOW_A126_AR22_Eta60];


% TOW for A140 
TOW_A140_Eta100=[TOW_A140_AR10_Eta100,TOW_A140_AR13_Eta100,TOW_A140_AR16_Eta100,TOW_A140_AR19_Eta100,TOW_A140_AR22_Eta100];
TOW_A140_Eta90=[TOW_A140_AR10_Eta90,TOW_A140_AR13_Eta90,TOW_A140_AR16_Eta90,TOW_A140_AR19_Eta90,TOW_A140_AR22_Eta90];
TOW_A140_Eta80=[TOW_A140_AR10_Eta80,TOW_A140_AR13_Eta80,TOW_A140_AR16_Eta80,TOW_A140_AR19_Eta80,TOW_A140_AR22_Eta80];
TOW_A140_Eta70=[TOW_A140_AR10_Eta70,TOW_A140_AR13_Eta70,TOW_A140_AR16_Eta70,TOW_A140_AR19_Eta70,TOW_A140_AR22_Eta70];
TOW_A140_Eta60=[TOW_A140_AR10_Eta60,TOW_A140_AR13_Eta60,TOW_A140_AR16_Eta60,TOW_A140_AR19_Eta60,TOW_A140_AR22_Eta60];


% figure 
% plot(TOW_A140_Eta80,'s-')

% TOW for A160 
TOW_A160_Eta100=[TOW_A160_AR10_Eta100,TOW_A160_AR13_Eta100,TOW_A160_AR16_Eta100,TOW_A160_AR19_Eta100,TOW_A160_AR22_Eta100];
TOW_A160_Eta90=[TOW_A160_AR10_Eta90,TOW_A160_AR13_Eta90,TOW_A160_AR16_Eta90,TOW_A160_AR19_Eta90,TOW_A160_AR22_Eta90];
TOW_A160_Eta80=[TOW_A160_AR10_Eta80,TOW_A160_AR13_Eta80,TOW_A160_AR16_Eta80,TOW_A160_AR19_Eta80,TOW_A160_AR22_Eta80];
TOW_A160_Eta70=[TOW_A160_AR10_Eta70,TOW_A160_AR13_Eta70,TOW_A160_AR16_Eta70,TOW_A160_AR19_Eta70,TOW_A160_AR22_Eta70];
TOW_A160_Eta60=[TOW_A160_AR10_Eta60,TOW_A160_AR13_Eta60,TOW_A160_AR16_Eta60,TOW_A160_AR19_Eta60,TOW_A160_AR22_Eta60];



% Range for A126

U=230; % cruise speed
I_sp=1/0.6; % S.F.C.
Dyn_pressure=0.5*0.4*U^2;

CL_A126_Eta100=TOW_A126_Eta100*9.81/(126*Dyn_pressure);
CL_A126_Eta90=TOW_A126_Eta90*9.81/(126*Dyn_pressure);
CL_A126_Eta80=TOW_A126_Eta80*9.81/(126*Dyn_pressure);
CL_A126_Eta70=TOW_A126_Eta70*9.81/(126*Dyn_pressure);
CL_A126_Eta60=TOW_A126_Eta60*9.81/(126*Dyn_pressure);


CL_A140_Eta100=TOW_A140_Eta100*9.81/(140*Dyn_pressure);
CL_A140_Eta90=TOW_A140_Eta90*9.81/(140*Dyn_pressure);
CL_A140_Eta80=TOW_A140_Eta80*9.81/(140*Dyn_pressure);
CL_A140_Eta70=TOW_A140_Eta70*9.81/(140*Dyn_pressure);
CL_A140_Eta60=TOW_A140_Eta60*9.81/(140*Dyn_pressure);


CL_A160_Eta100=TOW_A160_Eta100*9.81/(160*Dyn_pressure);
CL_A160_Eta90=TOW_A160_Eta90*9.81/(160*Dyn_pressure);
CL_A160_Eta80=TOW_A160_Eta80*9.81/(160*Dyn_pressure);
CL_A160_Eta70=TOW_A160_Eta70*9.81/(160*Dyn_pressure);
CL_A160_Eta60=TOW_A160_Eta60*9.81/(160*Dyn_pressure);



CD_A126_Eta100=CD0_A126_AR10*ones(1,5) + abs(A126_K).*CL_A126_Eta100.^2;
CD_A126_Eta90=CD0_A126_AR10*ones(1,5) + abs(A126_K).*CL_A126_Eta90.^2;
CD_A126_Eta80=CD0_A126_AR10*ones(1,5) + abs(A126_K).*CL_A126_Eta80.^2;
CD_A126_Eta70=CD0_A126_AR10*ones(1,5) + abs(A126_K).*CL_A126_Eta70.^2;
CD_A126_Eta60=CD0_A126_AR10*ones(1,5) + abs(A126_K).*CL_A126_Eta60.^2;


CD_A140_Eta100=CD0_A140_AR10*ones(1,5) + abs(A140_K).*CL_A140_Eta100.^2;
CD_A140_Eta90=CD0_A140_AR10*ones(1,5) + abs(A140_K).*CL_A140_Eta90.^2;
CD_A140_Eta80=CD0_A140_AR10*ones(1,5) + abs(A140_K).*CL_A140_Eta80.^2;
CD_A140_Eta70=CD0_A140_AR10*ones(1,5) + abs(A140_K).*CL_A140_Eta70.^2;
CD_A140_Eta60=CD0_A140_AR10*ones(1,5) + abs(A140_K).*CL_A140_Eta60.^2;



CD_A160_Eta100=CD0_A160_AR10*ones(1,5) + abs(A160_K).*CL_A160_Eta100.^2;
CD_A160_Eta90=CD0_A160_AR10*ones(1,5) + abs(A160_K).*CL_A160_Eta90.^2;
CD_A160_Eta80=CD0_A160_AR10*ones(1,5) + abs(A160_K).*CL_A160_Eta80.^2;
CD_A160_Eta70=CD0_A160_AR10*ones(1,5) + abs(A160_K).*CL_A160_Eta70.^2;
CD_A160_Eta60=CD0_A160_AR10*ones(1,5) + abs(A160_K).*CL_A160_Eta60.^2;




LD_A126_Eta100=CL_A126_Eta100./CD_A126_Eta100;
LD_A126_Eta90=CL_A126_Eta90./CD_A126_Eta90;
LD_A126_Eta80=CL_A126_Eta90./CD_A126_Eta80;
LD_A126_Eta70=CL_A126_Eta90./CD_A126_Eta70;
LD_A126_Eta60=CL_A126_Eta90./CD_A126_Eta60;


LD_A140_Eta100=CL_A140_Eta100./CD_A140_Eta100;
LD_A140_Eta90=CL_A140_Eta90./CD_A140_Eta90;
LD_A140_Eta80=CL_A140_Eta90./CD_A140_Eta80;
LD_A140_Eta70=CL_A140_Eta90./CD_A140_Eta70;
LD_A140_Eta60=CL_A140_Eta90./CD_A140_Eta60;


LD_A160_Eta100=CL_A160_Eta100./CD_A160_Eta100;
LD_A160_Eta90=CL_A160_Eta90./CD_A160_Eta90;
LD_A160_Eta80=CL_A160_Eta90./CD_A160_Eta80;
LD_A160_Eta70=CL_A160_Eta90./CD_A160_Eta70;
LD_A160_Eta60=CL_A160_Eta90./CD_A160_Eta60;


Wi_A126_Eta100=TOW_A126_Eta100;
Wi_A126_Eta90=TOW_A126_Eta90;
Wi_A126_Eta80=TOW_A126_Eta80;
Wi_A126_Eta70=TOW_A126_Eta70;
Wi_A126_Eta60=TOW_A126_Eta60;

Wi_A140_Eta100=TOW_A140_Eta100;
Wi_A140_Eta90=TOW_A140_Eta90;
Wi_A140_Eta80=TOW_A140_Eta80;
Wi_A140_Eta70=TOW_A140_Eta70;
Wi_A140_Eta60=TOW_A140_Eta60;


Wi_A160_Eta100=TOW_A160_Eta100;
Wi_A160_Eta90=TOW_A160_Eta90;
Wi_A160_Eta80=TOW_A160_Eta80;
Wi_A160_Eta70=TOW_A160_Eta70;
Wi_A160_Eta60=TOW_A160_Eta60;


Wf_A126_Eta100=TOW_A126_Eta100 - Fuel_Mass*ones(1,5);
Wf_A126_Eta90=TOW_A126_Eta90 - Fuel_Mass*ones(1,5);
Wf_A126_Eta80=TOW_A126_Eta80 - Fuel_Mass*ones(1,5);
Wf_A126_Eta70=TOW_A126_Eta70 - Fuel_Mass*ones(1,5);
Wf_A126_Eta60=TOW_A126_Eta60 - Fuel_Mass*ones(1,5);


Wf_A140_Eta100=TOW_A140_Eta100 - Fuel_Mass*ones(1,5);
Wf_A140_Eta90=TOW_A140_Eta90 - Fuel_Mass*ones(1,5);
Wf_A140_Eta80=TOW_A140_Eta80 - Fuel_Mass*ones(1,5);
Wf_A140_Eta70=TOW_A140_Eta70 - Fuel_Mass*ones(1,5);
Wf_A140_Eta60=TOW_A140_Eta60 - Fuel_Mass*ones(1,5);


Wf_A160_Eta100=TOW_A160_Eta100 - Fuel_Mass*ones(1,5);
Wf_A160_Eta90=TOW_A160_Eta90 - Fuel_Mass*ones(1,5);
Wf_A160_Eta80=TOW_A160_Eta80 - Fuel_Mass*ones(1,5);
Wf_A160_Eta70=TOW_A160_Eta70 - Fuel_Mass*ones(1,5);
Wf_A160_Eta60=TOW_A160_Eta60 - Fuel_Mass*ones(1,5);



Range126_Eta100=U.*LD_A126_Eta100.*I_sp.*log(Wi_A126_Eta100./Wf_A126_Eta100);
Range126_Eta90=U.*LD_A126_Eta90.*I_sp.*log(Wi_A126_Eta90./Wf_A126_Eta90);
Range126_Eta80=U.*LD_A126_Eta80.*I_sp.*log(Wi_A126_Eta80./Wf_A126_Eta80);
Range126_Eta70=U.*LD_A126_Eta80.*I_sp.*log(Wi_A126_Eta70./Wf_A126_Eta70);
Range126_Eta60=U.*LD_A126_Eta80.*I_sp.*log(Wi_A126_Eta60./Wf_A126_Eta60);


Range140_Eta100=U.*LD_A140_Eta100.*I_sp.*log(Wi_A140_Eta100./Wf_A140_Eta100);
Range140_Eta90=U.*LD_A140_Eta90.*I_sp.*log(Wi_A140_Eta90./Wf_A140_Eta90);
Range140_Eta80=U.*LD_A140_Eta80.*I_sp.*log(Wi_A140_Eta80./Wf_A140_Eta80);
Range140_Eta70=U.*LD_A140_Eta80.*I_sp.*log(Wi_A140_Eta70./Wf_A140_Eta70);
Range140_Eta60=U.*LD_A140_Eta80.*I_sp.*log(Wi_A140_Eta60./Wf_A140_Eta60);

% 
% figure 
% plot(LD_A140_Eta100,'s-')
% hold on 
% plot(LD_A140_Eta90,'s-')
% hold on
% plot(LD_A140_Eta80,'s-')
% hold on
% plot(LD_A140_Eta70,'s-')
% hold on
% plot(LD_A140_Eta60,'s-')
% 
% 
% figure 
% plot(log(Wi_A140_Eta100./Wf_A140_Eta100),'s-')
% hold on 
% plot(log(Wi_A140_Eta90./Wf_A140_Eta90),'s-')
% hold on 
% plot(log(Wi_A140_Eta80./Wf_A140_Eta80),'s-')
% hold on 
% plot(log(Wi_A140_Eta70./Wf_A140_Eta70),'s-')
% hold on 
% plot(log(Wi_A140_Eta60./Wf_A140_Eta60),'s-')
% 
% 
% 
% figure 
% plot(Wi_A140_Eta100,'s-')
% hold on 
% plot(Wi_A140_Eta90,'s-')
% hold on 
% plot(Wi_A140_Eta80,'s-')
% hold on 
% plot(Wi_A140_Eta70,'s-')
% hold on 
% plot(Wi_A140_Eta60,'s-')


Range160_Eta100=U.*LD_A160_Eta100.*I_sp.*log(Wi_A160_Eta100./Wf_A160_Eta100);
Range160_Eta90=U.*LD_A160_Eta90.*I_sp.*log(Wi_A160_Eta90./Wf_A160_Eta90);
Range160_Eta80=U.*LD_A160_Eta80.*I_sp.*log(Wi_A160_Eta80./Wf_A160_Eta80);
Range160_Eta70=U.*LD_A160_Eta80.*I_sp.*log(Wi_A160_Eta70./Wf_A160_Eta70);
Range160_Eta60=U.*LD_A160_Eta80.*I_sp.*log(Wi_A160_Eta60./Wf_A160_Eta60);


% L/D


figure 
plot(AR,LD_A126_Eta100,'s-','Color',[0, 0.5, 0],'MarkerFaceColor',[0, 0.5, 0],'LineWidth',1)
hold on 
plot(AR,LD_A140_Eta100,'s-','Color',[0.6350, 0.0780, 0.1840],'MarkerFaceColor',[0.6350, 0.0780, 0.1840],'LineWidth',1)
hold on 
plot(AR,LD_A160_Eta100,'s-','Color',[0.9290, 0.6940, 0.1250],'MarkerFaceColor',[0.9290, 0.6940, 0.1250],'LineWidth',1)

set(gcf,'Color','w')
xlabel('Wing aspect ratio','Interpreter','latex','FontSize',12)
ylabel('Lift to drag ratio (L/D)','Interpreter','latex','FontSize',12)
set(gca,'TickLabelInterpreter','latex')
legend('Wing area = 122 m$^2$','Wing area = 140 m$^2$','Wing area = 160 m$^2$','Interpreter','latex','FontSize',12,'Location','southeast')



figure 
plot(AR,Range126_Eta100,'o-','Color',[0.9290, 0.6940, 0.1250],'MarkerFaceColor',[0.9290, 0.6940, 0.1250],'LineWidth',1.0)
hold on 
plot(AR,Range126_Eta90,'r-o','MarkerFaceColor','r','LineWidth',1.0)
hold on 
plot(AR,Range126_Eta80,'b-o','MarkerFaceColor','b','LineWidth',1.0)
hold on 
plot(AR,Range126_Eta70,'o-','Color',[0.6350, 0.0780, 0.1840],'MarkerFaceColor',[0.6350, 0.0780, 0.1840],'LineWidth',1.0)
hold on 
plot(AR,Range126_Eta60,'o-','Color',[0, 0.5, 0],'MarkerFaceColor',[0, 0.5, 0],'LineWidth',1.0)
set(gcf,'Color','w')
xlabel('Wing aspect ratio','Interpreter','latex','FontSize',12)
ylabel('Breguet range (km)','Interpreter','latex','FontSize',12)
set(gca,'TickLabelInterpreter','latex')
legend('No FWT','$\eta$=10$\%$','$\eta$=20$\%$','$\eta$=30$\%$','$\eta$=40$\%$','Interpreter','latex','FontSize',12,'Location','southeast')


figure 
plot(AR,Range140_Eta100,'o-','Color',[0.9290, 0.6940, 0.1250],'MarkerFaceColor',[0.9290, 0.6940, 0.1250],'LineWidth',1.0)
hold on 
plot(AR,Range140_Eta90,'r-o','MarkerFaceColor','r','LineWidth',1.0)
hold on 
plot(AR,Range140_Eta80,'b-o','MarkerFaceColor','b','LineWidth',1.0)
hold on 
plot(AR,Range140_Eta70,'o-','Color',[0.6350, 0.0780, 0.1840],'MarkerFaceColor',[0.6350, 0.0780, 0.1840],'LineWidth',1.0)
hold on 
plot(AR,Range140_Eta60,'o-','Color',[0, 0.5, 0],'MarkerFaceColor',[0, 0.5, 0],'LineWidth',1.0)
set(gcf,'Color','w')
xlabel('Wing aspect ratio','Interpreter','latex','FontSize',12)
ylabel('Breguet range (km)','Interpreter','latex','FontSize',12)
set(gca,'TickLabelInterpreter','latex')
legend('No FWT','$\eta$=10$\%$','$\eta$=20$\%$','$\eta$=30$\%$','$\eta$=40$\%$','Interpreter','latex','FontSize',12,'Location','southeast')



figure 
plot(AR,Range160_Eta100,'o-','Color',[0.9290, 0.6940, 0.1250],'MarkerFaceColor',[0.9290, 0.6940, 0.1250],'LineWidth',1.0)
hold on 
plot(AR,Range160_Eta90,'r-o','MarkerFaceColor','r','LineWidth',1.0)
hold on 
plot(AR,Range160_Eta80,'b-o','MarkerFaceColor','b','LineWidth',1.0)
hold on 
plot(AR,Range160_Eta70,'o-','Color',[0.6350, 0.0780, 0.1840],'MarkerFaceColor',[0.6350, 0.0780, 0.1840],'LineWidth',1.0)
hold on 
plot(AR,Range160_Eta60,'o-','Color',[0, 0.5, 0],'MarkerFaceColor',[0, 0.5, 0],'LineWidth',1.0)
set(gcf,'Color','w')
xlabel('Wing aspect ratio','Interpreter','latex','FontSize',12)
ylabel('Breguet range (km)','Interpreter','latex','FontSize',12)
set(gca,'TickLabelInterpreter','latex')
legend('No FWT','$\eta$=10$\%$','$\eta$=20$\%$','$\eta$=30$\%$','$\eta$=40$\%$','Interpreter','latex','FontSize',12,'Location','southeast')




figure 

plot(AR,TOW_A126_Eta100,'rs')
hold on 
plot(AR,TOW_A126_Eta90,'bs')
hold on 
plot(AR,TOW_A126_Eta80,'ks')
hold on 
plot(AR,TOW_A126_Eta70,'gs')
hold on 
plot(AR,TOW_A126_Eta60,'ys')





%% Mission fuel 




%% Loads 

A126_AR16_Eta70_loads=load('A126/AR16/Res_AR16_Eta_70_Loads');


figure

plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Moment.pullup_cruise,'ks-','MarkerFaceColor','y')
% hold on 
% plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Moment.pullup_sealevel,'ks-','MarkerFaceColor',[1 0 1])
hold on 
plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Moment.g_sealevel_gust1,'ks-','MarkerFaceColor','g')
hold on
plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Moment.dive_sealevel,'ks-','MarkerFaceColor','r')
hold on 

% hold on 
% plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Moment.g_sealevel_gust2,'s-')

plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Moment.zero_fuel,'ks-','MarkerFaceColor','b') 
hold on
plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Moment.hinge_lock,'ks-','MarkerFaceColor',[0.9290, 0.6940, 0.1250]) 



% for sizing 

sizing_moment=[A126_AR16_Eta70_loads.Loads.Moment.pullup_cruise,A126_AR16_Eta70_loads.Loads.Moment.g_sealevel_gust1,A126_AR16_Eta70_loads.Loads.Moment.dive_sealevel,A126_AR16_Eta70_loads.Loads.Moment.zero_fuel,A126_AR16_Eta70_loads.Loads.Moment.hinge_lock];

sizing_moment=max(sizing_moment,[],2);

hold on 
plot(A126_AR16_Eta70_loads.Loads.Y-2, sizing_moment,'r--','LineWidth',2.5) 

axis([0 20.5 0 5e6])
set(gcf,'Color','w')
xlabel('Spanwise distance (m)','Interpreter','latex','FontSize',12)
ylabel('Bending moment (Nm)','Interpreter','latex','FontSize',12)


set(gca,'TickLabelInterpreter','latex')
set(gca,'FontSize',14)
legend('2.5g (36000 ft)','g + 1MC (3000 ft)', '-g (3000 ft)','Zero fuel case','Hinge locked case','Sizing','Interpreter','latex','FontSize',12)






figure

plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Shear.pullup_cruise,'ks-','MarkerFaceColor','y')
% hold on 
% plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Moment.pullup_sealevel,'ks-','MarkerFaceColor',[1 0 1])
hold on 
plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Shear.g_sealevel_gust1,'ks-','MarkerFaceColor','g')
hold on
plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Shear.dive_sealevel,'ks-','MarkerFaceColor','r')
hold on 

% hold on 
% plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Moment.g_sealevel_gust2,'s-')

plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Shear.zero_fuel,'ks-','MarkerFaceColor','b') 
hold on
plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Shear.hinge_lock,'ks-','MarkerFaceColor',[0.9290, 0.6940, 0.1250]) 



% for sizing 

sizing_moment=[A126_AR16_Eta70_loads.Loads.Shear.pullup_cruise,A126_AR16_Eta70_loads.Loads.Shear.g_sealevel_gust1,A126_AR16_Eta70_loads.Loads.Shear.dive_sealevel,A126_AR16_Eta70_loads.Loads.Shear.zero_fuel,A126_AR16_Eta70_loads.Loads.Shear.hinge_lock];

sizing_moment=max(sizing_moment,[],2);

hold on 
plot(A126_AR16_Eta70_loads.Loads.Y-2, sizing_moment,'r--','LineWidth',2.5) 

axis([0 20.5 0 6e5])
set(gcf,'Color','w')
xlabel('Spanwise distance (m)','Interpreter','latex','FontSize',12)
ylabel('Vertical shear (N)','Interpreter','latex','FontSize',12)


set(gca,'TickLabelInterpreter','latex')
set(gca,'FontSize',14)
legend('2.5g (36000 ft)','g + 1MC (3000 ft)', '-g (3000 ft)','Zero fuel case','Hinge locked case','Sizing','Interpreter','latex','FontSize',12)




figure

plot(A126_AR16_Eta70_loads.Loads.Y-2, abs(A126_AR16_Eta70_loads.Loads.Torque.pullup_cruise),'ks-','MarkerFaceColor','y')
% hold on 
% plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Moment.pullup_sealevel,'ks-','MarkerFaceColor',[1 0 1])
hold on 
plot(A126_AR16_Eta70_loads.Loads.Y-2, abs(A126_AR16_Eta70_loads.Loads.Torque.g_sealevel_gust1),'ks-','MarkerFaceColor','g')
hold on
plot(A126_AR16_Eta70_loads.Loads.Y-2, abs(A126_AR16_Eta70_loads.Loads.Torque.dive_sealevel),'ks-','MarkerFaceColor','r')
hold on 

% hold on 
% plot(A126_AR16_Eta70_loads.Loads.Y-2, A126_AR16_Eta70_loads.Loads.Moment.g_sealevel_gust2,'s-')

plot(A126_AR16_Eta70_loads.Loads.Y-2, abs(A126_AR16_Eta70_loads.Loads.Torque.zero_fuel),'ks-','MarkerFaceColor','b') 
hold on
plot(A126_AR16_Eta70_loads.Loads.Y-2, abs(A126_AR16_Eta70_loads.Loads.Torque.hinge_lock),'ks-','MarkerFaceColor',[0.9290, 0.6940, 0.1250]) 



% for sizing 

sizing_moment=[abs(A126_AR16_Eta70_loads.Loads.Torque.pullup_cruise),abs(A126_AR16_Eta70_loads.Loads.Torque.g_sealevel_gust1),abs(A126_AR16_Eta70_loads.Loads.Torque.dive_sealevel),...
    abs(A126_AR16_Eta70_loads.Loads.Torque.zero_fuel),abs(A126_AR16_Eta70_loads.Loads.Torque.hinge_lock)];

sizing_moment=max(sizing_moment,[],2);

hold on 
plot(A126_AR16_Eta70_loads.Loads.Y-2, sizing_moment,'r--','LineWidth',2.5) 

axis([0 20.5 0 2.5e5])
set(gcf,'Color','w')
xlabel('Spanwise distance (m)','Interpreter','latex','FontSize',12)
ylabel('Torque (Nm)','Interpreter','latex','FontSize',12)

set(gca,'TickLabelInterpreter','latex')
set(gca,'FontSize',14)
legend('2.5g (36000 ft)','g + 1MC (3000 ft)', '-g (3000 ft)','Zero fuel case','Hinge locked case','Sizing','Interpreter','latex','FontSize',12)


%% A320 drag polar

Cl=0:0.02:1;

Cd=0.0198+0.038*Cl.^2;
Cd1=0.0184+0.04*Cl.^2;

figure 
% plot(Cd,Cl,'k--','LineWidth',1.2)
% hold on 
plot(Cd1,Cl,'k-','LineWidth',1.2)

xlabel('Drag Coefficient','Interpreter','latex','FontSize',12)
ylabel('Lift Coefficient','Interpreter','latex','FontSize',12)
set(gcf,'Color','w')
set(gca,'TickLabelInterpreter','latex')
set(gca,'FontSize',14)
legend('CeRAS data','Sizing result','Interpreter','latex','FontSize',12,'Location','northwest')
